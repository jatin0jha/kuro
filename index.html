<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="icon" href="https://www.svgrepo.com/show/474291/arrow-short-left.svg" />
    <link rel="manifest" href="manifest.json" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <title>ARTISTRY</title>
    <link rel="stylesheet" href="style/style.css" />

    <script>
        // Check if the URL doesn't have a hash (just the base URL)
        if (!window.location.hash) {
            // Append #library to the URL
            window.location.hash = "#library";
        }
    </script>
</head>

<body>
    <div class="layout">
        <div style="
          display: flex;
          justify-content: space-between;
          margin: 5px;
          align-items: center;
        ">
            <div style="display: flex; align-items: center">
                <img src="https://www.svgrepo.com/show/474291/arrow-short-left.svg" height="40px" alt="" />
                <h3 style="margin: 0">ARTISTRY</h3>
            </div>
            <div class="burger" onclick="toggleMenu()" target="_blank">
                <img src="https://www.svgrepo.com/show/489710/burger-menu.svg" height="50px" alt="" />
            </div>
        </div>
        <div style="display: flex; align-items: center; width: 100%">
            <div class="top-row px-4" style="width: 100%">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search for plots..." oninput="searchFiles()" />
                    <div class="search-icon">
                        <svg fill="#000000" height="25px" width="25px" version="1.1" id="Capa_1"
                            xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                            viewBox="0 0 488.4 488.4" xml:space="preserve">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <g>
                                    <g>
                                        <path
                                            d="M0,203.25c0,112.1,91.2,203.2,203.2,203.2c51.6,0,98.8-19.4,134.7-51.2l129.5,129.5c2.4,2.4,5.5,3.6,8.7,3.6 s6.3-1.2,8.7-3.6c4.8-4.8,4.8-12.5,0-17.3l-129.6-129.5c31.8-35.9,51.2-83,51.2-134.7c0-112.1-91.2-203.2-203.2-203.2 S0,91.15,0,203.25z M381.9,203.25c0,98.5-80.2,178.7-178.7,178.7s-178.7-80.2-178.7-178.7s80.2-178.7,178.7-178.7 S381.9,104.65,381.9,203.25z">
                                        </path>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>
                </div>
            </div>
            <script>
                const searchBarInput = document.querySelector(".search-bar input");
                const searchBarContainer = document.querySelector(".search-bar");

                searchBarInput.addEventListener("focus", function () {
                    searchBarContainer.style.backgroundColor = "white";
                    searchBarContainer.style.boxShadow =
                        "var(--dt-shadow-elevation-1, 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15))";
                });

                searchBarInput.addEventListener("blur", function () {
                    searchBarContainer.style.backgroundColor = "#e9eef6";
                    searchBarContainer.style.boxShadow = "none";
                });
            </script>
        </div>
        <div id="menu">
            <div style="
            padding: 8px 16px 16px;
            max-width: 100%;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: space-between;
          ">
                <a href="https://forms.gle/Y167pEFsU8ApMCMm7" target="_blank"><button class="for-new">
                        <span><svg width="24" height="24" viewBox="0 0 24 24" focusable="false">
                                <path d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"></path>
                            </svg></span><span class="jYPt8c">New</span>
                    </button>
                </a>

                <label class="switch">
                    <input type="checkbox" id="toggle" />
                    <span class="slider round"></span>
                </label>
            </div>
            <a href="#library" class="nav-link">
                <div>
                    <span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span>Library
                </div>
            </a>
            <a href="#recent" class="nav-link">
                <div>
                    <span class="bi bi-clock-fill-nav-menu" aria-hidden="true"></span>Recent
                </div>
            </a>
            <a href="#about" class="nav-link">
                <div>
                    <span class="bi bi-list-nested-nav-menu" aria-hidden="true"></span>About
                </div>
            </a>

            <script>
                function toggleMenu() {
                    const menu = document.getElementById("menu");
                    menu.style.display =
                        menu.style.display === "none" || menu.style.display === ""
                            ? "block"
                            : "none";
                }
            </script>
        </div>
        <div id="lib-page" class="bg-white p-2" style="overflow-y: scroll; border-radius: 10px">
            <div id="library" class="section">
                <h1>Library</h1>
                <div class="files-grid" id="myContentContainer"></div>
                <div id="loading">
                    <img src="https://i.gifer.com/XOsX.gif" alt="Loading..." />
                </div>

                <a href="https://github.com/jatin0jha/kuro"><button style="
                background-color: black;
                color: white;
                border-radius: 15px;
                border: none;
                padding: 5px 20px;
                position: absolute;
                bottom: 20px;
                left: 20px;
              ">
                        <img src="https://www.svgrepo.com/show/439171/github.svg" height="50px" alt="" />Contribute
                    </button></a>
            </div>

            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    // This event listener ensures that the JavaScript code will run after the DOM content is fully loaded.

                    const toggleSwitch = document.getElementById("toggle");
                    const libPage = document.getElementById("lib-page");
                    const body = document.querySelector("body");
                    const libBookCard = document.getElementById("lib-book-card");
                    const cretiveText = document.getElementById("creative_expression");
                    const communityConnection = document.getElementById(
                        "community_connection"
                    );
                    const globalShowcase = document.getElementById("global_showcase");
                    // Retrieving necessary elements from the DOM and storing them in variables.

                    toggleSwitch.addEventListener("change", function () {
                        // Adding an event listener for the change event on the toggle switch.
                        if (this.checked) {
                            // If the toggle switch is checked (in the "on" position):

                            libPage.classList.remove("bg-white");
                            libPage.classList.add("bg-black");
                            body.classList.add("bg-dark");
                            cretiveText.classList.add("text-white");
                            communityConnection.classList.add("text-white");
                            globalShowcase.classList.add("text-white");
                            libBookCard.classList.remove("bg-light");
                            libBookCard.classList.add("bg-dark");
                            // Change the background colors and styles to the dark mode.
                        } else {
                            // If the toggle switch is unchecked (in the "off" position):

                            libPage.classList.remove("bg-black");
                            libPage.classList.add("bg-white");
                            body.classList.remove("bg-dark");
                            cretiveText.classList.remove("text-white");
                            communityConnection.classList.remove("text-white");
                            globalShowcase.classList.remove("text-white");
                            libBookCard.classList.remove("bg-dark");
                            libBookCard.classList.add("bg-light");
                            // Change the background colors and styles back to the light mode.
                        }
                    });
                });
            </script>

            <div id="recent" class="section">
                <h1>Recent</h1>
                <script>
                    // Function to handle when a user clicks on a card link
                    function handleCardClick(event) {
                        // Capture the data of the clicked card
                        const cardData = {
                            title:
                                event.currentTarget.querySelector(".content-info h2")
                                    .textContent,
                            description:
                                event.currentTarget.querySelector(".content-info p")
                                    .textContent,
                            pdfLink: event.currentTarget
                                .querySelector(".content-info a")
                                .getAttribute("href"),
                            coverImage: event.currentTarget
                                .querySelector(".cover-image img")
                                .getAttribute("src"),
                        };

                        // Store the captured card data locally
                        saveCardDataLocally(cardData);

                        // Render the recently opened card
                        renderRecentCard(cardData);
                    }

                    // Function to save card data locally
                    function saveCardDataLocally(cardData) {
                        // Get the previously saved card data from local storage
                        let recentCards =
                            JSON.parse(localStorage.getItem("recentCards")) || [];

                        // Add the new card data to the array of recent cards
                        recentCards.push(cardData);

                        // Limit the number of recent cards to keep (if needed)
                        // Adjust the limit as per your requirement
                        const MAX_RECENT_CARDS = 10;
                        if (recentCards.length > MAX_RECENT_CARDS) {
                            recentCards = recentCards.slice(-MAX_RECENT_CARDS);
                        }

                        // Save the updated recent cards data back to local storage
                        localStorage.setItem("recentCards", JSON.stringify(recentCards));
                    }

                    // Function to render the recently opened card
                    function renderRecentCard(cardData) {
                        const recentContainer = document.getElementById("recent");

                        // Generate HTML markup for the recent card
                        const recentCardHTML = `
                            <div id="lib-book-card" class="bg-light p-1 content-container">
                                <div class="cover-image">
                                    <a href="${cardData.pdfLink}" target="_blank">
                                        <img src="${cardData.coverImage}" alt="">
                                    </a>
                                </div>
                                <div class="p-2 content-info">
                                    <h2 class="text-dark">${cardData.title}</h2>
                                    <p>${cardData.description}</p>
                                    <div style="height: 100%;"></div>
                                    <a href="${cardData.pdfLink}" target="_blank">
                                        <img src="https://raw.githubusercontent.com/jatin0jha/jatin0jha/ba706fea77d7890b95a1c0863b6213c48c317de2/upload.svg" alt="">
                                    </a>
                                </div>
                            </div>
                        `;

                        // Append the recent card HTML to the recent container
                        recentContainer.insertAdjacentHTML("beforeend", recentCardHTML);
                    }

                    // Add event listeners to card links in the content container
                    document
                        .getElementById("myContentContainer")
                        .addEventListener("click", function (event) {
                            if (event.target.closest(".content-container")) {
                                handleCardClick(event);
                            }
                        });

                    // Function to render recently opened cards from local storage
                    function renderRecentCardsFromLocalStorage() {
                        const recentCards =
                            JSON.parse(localStorage.getItem("recentCards")) || [];

                        // Render each recent card
                        recentCards.forEach((cardData) => {
                            renderRecentCard(cardData);
                        });
                    }

                    // Render the recent cards when the page loads
                    window.addEventListener("DOMContentLoaded", function () {
                        renderRecentCardsFromLocalStorage();
                    });
                </script>
            </div>
            <div id="about" class="section">
                <div class="welcome" id="welcome">
                    <header class="hero2">
                        <div class="container">
                            <h1><i>Welcome to Artistry Hub</i></h1>
                            <p>A Creative Haven for 2D & 3D Artists</p>
                        </div>
                    </header>
                </div>
                <section class="about">
                    <div class="container">
                        <div class="row" style="color: black">
                            <div class="col-md-4 feature">
                                <i class="fas fa-palette feature-icon"></i>
                                <h2 class="feature-title" id="creative_expression">
                                    Creative Expression
                                </h2>
                                <p class="feature-description" style="color: black">
                                    Artistry Hub provides a vibrant canvas for artists to
                                    express their creativity without limits. Whether it's 2D
                                    illustrations or immersive 3D renders, unleash your
                                    imagination and bring your visions to life.
                                </p>
                            </div>
                            <div class="col-md-4 feature">
                                <i class="fas fa-users feature-icon"></i>
                                <h2 class="feature-title" id="community_connection">
                                    Community Connection
                                </h2>
                                <p class="feature-description" style="color: black">
                                    Join a supportive community of fellow artists where
                                    inspiration thrives and collaborations flourish. Share your
                                    ideas, connect with like-minded individuals, and embark on
                                    artistic journeys together.
                                </p>
                            </div>
                            <div class="col-md-4 feature">
                                <i class="fas fa-globe-americas feature-icon"></i>
                                <h2 class="feature-title" id="global_showcase">
                                    Global Showcase
                                </h2>
                                <p class="feature-description" style="color: black">
                                    Explore a diverse showcase of artwork from talented artists
                                    around the globe. From traditional techniques to
                                    cutting-edge innovations, discover a world of creativity
                                    that transcends boundaries.
                                </p>
                            </div>
                        </div>
                        <div class="row mt-5">
                            <div class="col-md-12">
                                <h2>Join Artistry Hub Today</h2>
                                <p>
                                    Whether you're an experienced artist or just starting your
                                    creative journey, Artistry Hub welcomes you with open arms.
                                    Join our community today and unlock endless opportunities to
                                    elevate your artistry.
                                </p>
                                <a href="#" class="btn btn-primary join-button">Join Now</a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        <script>
            // Select all navigation links
            const navButtons = document.querySelectorAll(".nav-link");

            // Initialize variable to store the previously clicked link
            let previousNavButton = null;

            // Set the initial active link to #library
            const initialActiveLink = document.querySelector('a[href="#library"]');
            initialActiveLink.style.backgroundColor = "rgb(194, 231, 255)";
            previousNavButton = initialActiveLink;

            // Get all sections
            const sections = document.querySelectorAll(".section");

            // Show the section based on the hash in the URL
            function showSection(hash) {
                // Hide all sections
                sections.forEach((section) => {
                    section.style.display = "none";
                });

                // Show the section corresponding to the hash
                const targetSection = document.getElementById(hash);
                if (targetSection) {
                    targetSection.style.display = "block";
                }
            }

            // Function to handle navigation link clicks
            function handleNavClick(event) {
                event.preventDefault(); // Prevent default anchor behavior
                event.stopPropagation(); // Stop event propagation to prevent issues with navigation logic

                const navButton = event.currentTarget;

                // Reset the background color of the previously clicked link
                if (previousNavButton) {
                    previousNavButton.style.backgroundColor = "";
                }

                // Set the background color of the clicked link
                navButton.style.backgroundColor = "rgb(194, 231, 255)";

                // Update the previously clicked link
                previousNavButton = navButton;

                // Show the corresponding section
                const hash = navButton.getAttribute("href").substr(1); // Extract the hash from the href attribute
                showSection(hash);
            }

            // Add click event listener to navigation links
            navButtons.forEach((navButton) => {
                navButton.addEventListener("click", handleNavClick);
            });

            // Show the appropriate section when the page loads
            window.addEventListener("DOMContentLoaded", function () {
                const hash = window.location.hash.substr(1); // Extract the hash from the URL
                showSection(hash);
            });
        </script>
    </div>
</body>

<script>
    let searchData; // To store the original data for reset

    // Hide the content container and show the loading animation
    document.getElementById("myContentContainer").style.display = "none";
    document.getElementById("loading").style.display = "block";

    fetch(
        "https://script.googleusercontent.com/macros/echo?user_content_key=q4wwBgNWIKYx4Eu7_GOqNuiQS1U6pATiPYRrojAmxjq9ELwCCRmmdDKDbnTZ8DcZm2u_5E-VUyM-TEBO7JbGIFHn_N0BhvcBm5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnN3qIGTLz4U0QCznjMAiFIBjg3sDBxIuBUFb6llJZ-HsCkaRr-U-pvhhonTEC3cIx8Mz7f7RLIjIfcJSmWxs5bNBKABpDR5oUg&lib=MTKY7IWoEIUZ-OaLI0TuvsCUIHiZ-_zcK"
    )
        .then((res) => res.json())
        .then((data) => {
            // Once the data is loaded, hide the loading animation and show the content container
            document.getElementById("myContentContainer").style.display = "grid";
            document.getElementById("loading").style.display = "none";

            searchData = data.content; // Store the original data for reset
            renderFiles(data.content); // Render the files initially
        })
        .catch((error) => {
            console.error("Error fetching data:", error);
            // In case of an error, hide the loading animation and show an error message
            document.getElementById("loading").innerHTML =
                "Error fetching data. Please try again later.";
        });

    // Function to render files based on search input
    function renderFiles(data) {
        let content = "";

        // Iterate over the data to create content for each item
        data.forEach((item) => {
            let title = item[2];
            let description = item[3];
            let pdfLink = item[4];
            let coverImage = item[5]; // Assuming the cover image URL is in the 6th column

            // Check if the cover image URL is valid
            if (
                coverImage &&
                (coverImage.startsWith("http://") ||
                    coverImage.startsWith("https://"))
            ) {
                let itemHTML = `
                    <div id="lib-book-card" class="bg-light p-1 content-container">
                        <div class="cover-image">
                            <a href="${pdfLink}" target="_blank">
                                <img src="${coverImage}" alt="">
                            </a>
                        </div>
                        <div class="p-2 content-info">
                            <h3 class="text-dark">${title}</h3>
                            <p>${description}</p>
                            <div style="height: 100%;"></div>
                            <a href="${pdfLink}" target="_blank">
                                <img src="https://raw.githubusercontent.com/jatin0jha/jatin0jha/ba706fea77d7890b95a1c0863b6213c48c317de2/upload.svg" alt="">
                            </a>
                        </div>
                    </div>
                `;
                content += itemHTML;
            }
        });

        // Populate the content into the content container
        document.getElementById("myContentContainer").innerHTML = content;
    }

    // Function to handle search input
    function searchFiles() {
        let searchTerm = document
            .getElementById("searchInput")
            .value.toLowerCase();
        let filteredData = searchData.filter((item) => {
            let title = item[2].toLowerCase();
            let description = item[3].toLowerCase();
            return title.includes(searchTerm) || description.includes(searchTerm);
        });
        renderFiles(filteredData);
    }
</script>

<script>
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
            navigator.serviceWorker.register("/service_worker.js").then(
                function (registration) {
                    // Registration was successful
                    console.log(
                        "ServiceWorker registration successful with scope: ",
                        registration.scope
                    );
                },
                function (err) {
                    // registration failed :(
                    console.log("ServiceWorker registration failed: ", err);
                }
            );
        });
    }
</script>

</html>
